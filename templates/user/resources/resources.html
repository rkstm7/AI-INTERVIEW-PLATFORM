{% extends 'base.html' %}

{% block content %}
<div class="container my-5" style="margin-top: 140px !important; margin-bottom: 100px !important">

  <!-- Top Container: Role Selection -->
  <div class="card shadow-sm p-4 mb-4">
    <h2 class="text-center mb-4 fw-bolder fs-2" style="color: #dd3d15ff;">Select Job/Domain Role to Start Learning</h2>

    <form method="GET" autocomplete="off" class="mb-3">
      <div class="mb-3">
        <select name="role_id" class="form-select form-select-lg" required>
          <option value="" disabled {% if not selected_role_id %}selected{% endif %}>Select a job role</option>
          {% for role in job_roles %}
            <option value="{{ role.id }}" {% if role.id == selected_role_id %}selected{% endif %}>
              {{ role.name }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="d-flex flex-wrap gap-3 justify-content-center">
        <button type="submit" name="action" value="resources" class="btn btn-primary btn-lg flex-fill flex-md-auto">
          View Here
        </button>
        <button type="submit" name="action" value="qa" class="btn btn-success btn-lg flex-fill flex-md-auto">
          Start Learning
        </button>
      </div>
    </form>
  </div>

  <!-- Bottom Container: Learning Resources -->
  {% if selected_role_id and action == 'resources' %}
  <div class="card shadow-sm p-4 mb-4">
    <h3 class="text-primary mb-4 text-center">Learning Resources for "{{ selected_role_name }}"</h3>

    {% if resources %}
      <div class="d-flex flex-column gap-4">
        {% for r in resources %}
        <div class="card shadow-sm w-100">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title text-primary">{{ r['title'] }}</h5>
            <p class="card-text fs-5" style="text-align: justify;  font-weight: 500 !important">{{ r['description']|truncate(500) }}</p>
            <a href="{{ r['url'] }}" target="_blank" rel="noopener" class="btn btn-outline-primary mt-auto">Visit</a>
            
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="alert alert-info text-center">
        No resources found for this role.
      </div>
    {% endif %}
  </div>
  {% endif %}

  <!-- Back to Dashboard -->
  <div class="d-flex justify-content-center mt-5">
    <a href="{{ url_for('user_dashboard.dashboard') }}" class="btn btn-outline-primary px-4">
      &larr; Back to Dashboard
    </a>
  </div>

</div>
{% endblock %}
